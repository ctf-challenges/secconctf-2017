#!/usr/bin/python3

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
host = ""
s.connect((host, 8000))

s.recv(len("[dev0 to dev1]:"))
data = s.recv(120)
## todo
# s.send(payload)
data = s.recv(len("\n[dev1 to dev0]: OK\n"))

data = s.recv(len("[dev1 to dev0]:"))
data = s.recv(120)
## todo
# s.send(payload)
s.recv(len("\n[dev0 to dev1]: OK\n"))

data = s.recv(len("[KBKDF: SHA256, Encryption: AES]\n"))
## derive keys

data = s.recv(len("[dev0 to dev1]:"))
data = s.recv(256)

## todo
# mitm
# s.send(ct)

data = s.recv(len("\n[dev1 to dev0]: OK\n"))
data = s.recv(len("[dev1 to dev0]:"))

data = s.recv(256)
## todo
# decrypt




